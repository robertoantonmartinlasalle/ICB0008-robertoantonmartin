<!--
  Componente: player-list.page.html
  Esta vista muestra la lista paginada de jugadores obtenidos de la API externa.
  Para cada jugador se indica si es favorito mediante una estrella.
  TambiÃ©n he integrado dos botones: uno para abrir la cÃ¡mara y otro para compartir.
  He preferido ubicar estos botones directamente junto al nombre del jugador, ya que
  asÃ­ tiene mÃ¡s sentido visual y funcional que agruparlos en la cabecera.
  Esta soluciÃ³n es compatible tanto en Android como en navegador web.
-->

<ion-header>
  <ion-toolbar>
    <ion-title>Lista de Jugadores</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="contenido">

    <!-- Spinner principal mientras se cargan los datos por primera vez -->
    <ion-spinner 
      name="crescent" 
      *ngIf="cargando && jugadores.length === 0" 
      class="spinner">
    </ion-spinner>

    <!-- Lista de jugadores, se renderiza cuando hay jugadores disponibles -->
    <ion-list *ngIf="jugadores.length > 0">
      <ion-item 
        *ngFor="let jugador of jugadores" 
        button 
        (click)="verDetalleJugador(jugador.id)">

        <!-- Contenedor del contenido visual del jugador -->
        <div class="info-jugador">

          <!-- Nombre del jugador -->
          <p>
            <strong>
              {{ jugador.first_name }} {{ jugador.last_name }}

              <!-- Estrella amarilla solo si es favorito -->
              <span *ngIf="jugador.esFavorito" class="estrella-favorito">
                â˜…
              </span>
            </strong>
          </p>

          <!-- Altura -->
          <p>
            Altura: 
            {{ jugador.height && jugador.height !== '' ? jugador.height : '-' }}
          </p>

          <!-- Peso -->
          <p>
            Peso: 
            {{ jugador.weight && jugador.weight !== '' ? jugador.weight + ' lbs' : '-' }}
          </p>

          <!-- Equipo -->
          <p>
            Equipo: {{ jugador.team?.full_name || '-' }}
          </p>

          <!-- Acciones por jugador: cÃ¡mara y compartir -->
          <div class="acciones-jugador">

            <!-- ðŸ“¸ BotÃ³n para abrir la cÃ¡mara del dispositivo.
                 Pasamos el ID del jugador para luego redirigir al detalle correspondiente.
                 $event.stopPropagation evita que se dispare el click del ion-item -->
            <ion-button 
              fill="clear" 
              size="small" 
              (click)="abrirCamaraJugador(jugador.id); $event.stopPropagation()">
              CÃ¡mara
            </ion-button>

            <!-- ðŸ“¤ BotÃ³n para compartir el nombre del jugador mediante Web Share API o nativo -->
            <ion-button 
              fill="clear" 
              size="small" 
              (click)="compartirJugador(jugador.first_name + ' ' + jugador.last_name); $event.stopPropagation()">
              Compartir
            </ion-button>

          </div>

        </div>

      </ion-item>
    </ion-list>

    <!-- BotÃ³n para cargar mÃ¡s jugadores (paginaciÃ³n) -->
    <div class="boton-cargar-mas" *ngIf="hayMas && !cargando">
      <ion-button expand="block" (click)="cargarJugadores()">
        Cargar mÃ¡s
      </ion-button>
    </div>

    <!-- Spinner mientras se cargan mÃ¡s resultados -->
    <ion-spinner 
      name="dots" 
      *ngIf="cargando && jugadores.length > 0" 
      class="spinner">
    </ion-spinner>
    
  </div>
</ion-content>
